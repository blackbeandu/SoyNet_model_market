[system]
license_file=../utils/license_trial.key

platform=nvidia
engine_workspace=110676224
engine_serialize=$ENGINE_SERIALIZE
engine_file=$ENGINE_FILE
weight_file=$WEIGHT_FILE
log_file=$LOG_FILE

precision_mode=32

quant_batch=4

[model] name=$MODEL_NAME
framework=tensorflow
input=XX,$BATCH_SIZE,$INPUT_SIZE,3,u8

[default] type=conv2d kernel=1 stride=1 group=1 dilation=1 weight_order=wrbmv pad=same bn_eps=0.001 act=swish
[default] type=pooling mode=gavg pad=valid
[default] type=eltwise mode=prod

########################################################################################################################
[preproc] mode=efficientdet input_mode=$INPUT_MODE resize=$MODEL_SIZE norm_mode=zp1ms resize_mode=align_center mean_rgb=0.485,0.456,0.406 std_rgb=0.229,0.224,0.225 output=M_S

#stem [c,1280,1280]->[c,640,640]
[conv2d] channel=48 kernel=3 stride=2

#BLOCK 1 [c,640,640]->[c,640,640] (3)

[conv2d] kernel=3 group=48 channel=48 output=B1A_ACT
[pooling] 
[reshape] shape=-1,1,1
[conv2d] channel=12 weight_order=wa
[conv2d] channel=48 weight_order=wa act=sigmoid
[eltwise] input=*,B1A_ACT
[conv2d] channel=24 act=linear output=B1A_PRO

[conv2d] kernel=3 group=24 channel=24 output=B1B_ACT
[pooling]
[reshape] shape=-1,1,1
[conv2d] channel=6 weight_order=wa
[conv2d] channel=24 weight_order=wa act=sigmoid
[eltwise] input=*,B1B_ACT 
[conv2d] channel=24 act=linear
[eltwise] mode=add input=*,B1A_PRO output=B1B_ADD 

[conv2d] kernel=3 group=24 channel=24 output=B1C_ACT
[pooling]
[reshape] shape=-1,1,1
[conv2d] channel=6 weight_order=wa
[conv2d] channel=24 weight_order=wa act=sigmoid
[eltwise] input=*,B1C_ACT 
[conv2d] channel=24 act=linear 
[eltwise] mode=add input=*,B1B_ADD 

#BLOCK 2 [c,228,228]->[c,114,114] (5)

[conv2d] channel=144
[conv2d] kernel=3 group=144 channel=144 stride=2 output=B2A_ACT
[pooling]
[reshape] shape=-1,1,1
[conv2d] channel=6 weight_order=wa
[conv2d] channel=144 weight_order=wa act=sigmoid
[eltwise] input=*,B2A_ACT
[conv2d] channel=40 act=linear output=B2A_PRO

[conv2d] channel=240
[conv2d] kernel=3 group=240 channel=240 output=B2B_ACT
[pooling] 
[reshape] shape=-1,1,1
[conv2d] channel=10 weight_order=wa
[conv2d] channel=240 weight_order=wa act=sigmoid
[eltwise] input=*,B2B_ACT 
[conv2d] channel=40 act=linear
[eltwise] mode=add input=*,B2A_PRO output=B2B_ADD

[conv2d] channel=240
[conv2d] kernel=3 group=240 channel=240 output=B2C_ACT
[pooling] 
[reshape] shape=-1,1,1
[conv2d] channel=10 weight_order=wa
[conv2d] channel=240 weight_order=wa act=sigmoid
[eltwise] input=*,B2C_ACT
[conv2d] channel=40 act=linear 
[eltwise] mode=add input=*,B2B_ADD output=B2C_ADD

[conv2d] channel=240
[conv2d] kernel=3 group=240 channel=240 output=B2D_ACT
[pooling] 
[reshape] shape=-1,1,1
[conv2d] channel=10 weight_order=wa
[conv2d] channel=240 weight_order=wa act=sigmoid
[eltwise] input=*,B2D_ACT
[conv2d] channel=40 act=linear
[eltwise] mode=add input=*,B2C_ADD output=B2D_ADD

[conv2d] channel=240
[conv2d] kernel=3 group=240 channel=240 output=B2E_ACT
[pooling]
[reshape] shape=-1,1,1
[conv2d] channel=10 weight_order=wa
[conv2d] channel=240 weight_order=wa act=sigmoid
[eltwise] input=*,B2E_ACT
[conv2d] channel=40 act=linear 
[eltwise] mode=add input=*,B2D_ADD

#BLOCK 3 [c,114,114]->[c,57,57] (5),(kernel=5)

[conv2d] channel=240
[conv2d] kernel=5 group=240 channel=240 stride=2 output=B3A_ACT
[pooling] 
[reshape] shape=-1,1,1
[conv2d] channel=10 weight_order=wa
[conv2d] channel=240 weight_order=wa act=sigmoid
[eltwise] input=*,B3A_ACT
[conv2d] channel=64 act=linear output=B3A_PRO

[conv2d] channel=384
[conv2d] kernel=5 group=384 channel=384 output=B3B_ACT
[pooling] 
[reshape] shape=-1,1,1
[conv2d] channel=16 weight_order=wa
[conv2d] channel=384 weight_order=wa act=sigmoid
[eltwise] input=*,B3B_ACT 
[conv2d] channel=64 act=linear
[eltwise] mode=add input=*,B3A_PRO output=B3B_ADD

[conv2d] channel=384
[conv2d] kernel=5 group=384 channel=384 output=B3C_ACT
[pooling] 
[reshape] shape=-1,1,1
[conv2d] channel=16 weight_order=wa
[conv2d] channel=384 weight_order=wa act=sigmoid
[eltwise] input=*,B3C_ACT
[conv2d] channel=64 act=linear 
[eltwise] mode=add input=*,B3B_ADD output=B3C_ADD

[conv2d] channel=384
[conv2d] kernel=5 group=384 channel=384 output=B3D_ACT
[pooling] 
[reshape] shape=-1,1,1
[conv2d] channel=16 weight_order=wa
[conv2d] channel=384 weight_order=wa act=sigmoid
[eltwise] input=*,B3D_ACT
[conv2d] channel=64 act=linear 
[eltwise] mode=add input=*,B3C_ADD output=B3D_ADD

[conv2d] channel=384
[conv2d] kernel=5 group=384 channel=384 kernel=5 output=B3E_ACT
[pooling]
[reshape] shape=-1,1,1
[conv2d] channel=16 weight_order=wa
[conv2d] channel=384 weight_order=wa act=sigmoid
[eltwise] input=*,B3E_ACT
[conv2d] channel=64 act=linear 
[eltwise] mode=add input=*,B3D_ADD output=P3

#BLOCK 4 [c,57,57]->[c,29,29] (7)

[conv2d] channel=384
[conv2d] kernel=3 group=384 channel=384 stride=2 output=B4A_ACT
[pooling] 
[reshape] shape=-1,1,1
[conv2d] channel=16 weight_order=wa
[conv2d] channel=384 weight_order=wa act=sigmoid
[eltwise] input=*,B4A_ACT
[conv2d] channel=128 act=linear output=B4A_PRO

[conv2d] channel=768
[conv2d] kernel=3 group=768 channel=768 output=B4B_ACT
[pooling] 
[reshape] shape=-1,1,1
[conv2d] channel=32 weight_order=wa
[conv2d] channel=768 weight_order=wa act=sigmoid
[eltwise] input=*,B4B_ACT 
[conv2d] channel=128 act=linear
[eltwise] mode=add input=*,B4A_PRO output=B4B_ADD

[conv2d] channel=768
[conv2d] kernel=3 group=768 channel=768 output=B4C_ACT
[pooling] 
[reshape] shape=-1,1,1
[conv2d] channel=32 weight_order=wa
[conv2d] channel=768 weight_order=wa act=sigmoid
[eltwise] input=*,B4C_ACT
[conv2d] channel=128 act=linear 
[eltwise] mode=add input=*,B4B_ADD output=B4C_ADD

[conv2d] channel=768
[conv2d] kernel=3 group=768 channel=768 output=B4D_ACT
[pooling] 
[reshape] shape=-1,1,1
[conv2d] channel=32 weight_order=wa
[conv2d] channel=768 weight_order=wa act=sigmoid
[eltwise] input=*,B4D_ACT
[conv2d] channel=128 act=linear 
[eltwise] mode=add input=*,B4C_ADD output=B4D_ADD

[conv2d] channel=768
[conv2d] kernel=3 group=768 channel=768 output=B4E_ACT
[pooling] 
[reshape] shape=-1,1,1
[conv2d] channel=32 weight_order=wa
[conv2d] channel=768 weight_order=wa act=sigmoid
[eltwise] input=*,B4E_ACT
[conv2d] channel=128 act=linear 
[eltwise] mode=add input=*,B4D_ADD output=B4E_ADD

[conv2d] channel=768
[conv2d] kernel=3 group=768 channel=768 output=B4F_ACT
[pooling] 
[reshape] shape=-1,1,1
[conv2d] channel=32 weight_order=wa
[conv2d] channel=768 weight_order=wa act=sigmoid
[eltwise] input=*,B4F_ACT
[conv2d] channel=128 act=linear 
[eltwise] mode=add input=*,B4E_ADD output=B4F_ADD

[conv2d] channel=768
[conv2d] kernel=3 group=768 channel=768 output=B4G_ACT
[pooling]
[reshape] shape=-1,1,1
[conv2d] channel=32 weight_order=wa
[conv2d] channel=768 weight_order=wa act=sigmoid
[eltwise] input=*,B4G_ACT
[conv2d] channel=128 act=linear 
[eltwise] mode=add input=*,B4F_ADD

#BLOCK 5 [c,29,29]->[c,29,29] (7), kernel=5)

[conv2d] channel=768
[conv2d] kernel=5 group=768 channel=768 output=B5A_ACT
[pooling] 
[reshape] shape=-1,1,1
[conv2d] channel=32 weight_order=wa
[conv2d] channel=768 weight_order=wa act=sigmoid
[eltwise] input=*,B5A_ACT
[conv2d] channel=176 act=linear output=B5A_PRO

[conv2d] channel=1056
[conv2d] kernel=5 group=1056 channel=1056 output=B5B_ACT
[pooling] 
[reshape] shape=-1,1,1
[conv2d] channel=44 weight_order=wa
[conv2d] channel=1056 weight_order=wa act=sigmoid
[eltwise] input=*,B5B_ACT 
[conv2d] channel=176 act=linear
[eltwise] mode=add input=*,B5A_PRO output=B5B_ADD

[conv2d] channel=1056
[conv2d] kernel=5 group=1056 channel=1056 output=B5C_ACT
[pooling] 
[reshape] shape=-1,1,1
[conv2d] channel=44 weight_order=wa
[conv2d] channel=1056 weight_order=wa act=sigmoid
[eltwise] input=*,B5C_ACT
[conv2d] channel=176 act=linear 
[eltwise] mode=add input=*,B5B_ADD output=B5C_ADD

[conv2d] channel=1056
[conv2d] kernel=5 group=1056 channel=1056 output=B5D_ACT
[pooling] 
[reshape] shape=-1,1,1
[conv2d] channel=44 weight_order=wa
[conv2d] channel=1056 weight_order=wa act=sigmoid
[eltwise] input=*,B5D_ACT
[conv2d] channel=176 act=linear 
[eltwise] mode=add input=*,B5C_ADD output=B5D_ADD

[conv2d] channel=1056
[conv2d] kernel=5 group=1056 channel=1056 output=B5E_ACT
[pooling] 
[reshape] shape=-1,1,1
[conv2d] channel=44 weight_order=wa
[conv2d] channel=1056 weight_order=wa act=sigmoid
[eltwise] input=*,B5E_ACT
[conv2d] channel=176 act=linear 
[eltwise] mode=add input=*,B5D_ADD output=B5E_ADD

[conv2d] channel=1056
[conv2d] kernel=5 group=1056 channel=1056 output=B5F_ACT
[pooling] 
[reshape] shape=-1,1,1
[conv2d] channel=44 weight_order=wa
[conv2d] channel=1056 weight_order=wa act=sigmoid
[eltwise] input=*,B5F_ACT
[conv2d] channel=176 act=linear 
[eltwise] mode=add input=*,B5E_ADD output=B5F_ADD

[conv2d] channel=1056
[conv2d] kernel=5 group=1056 channel=1056 kernel=5 output=B5G_ACT
[pooling]
[reshape] shape=-1,1,1
[conv2d] channel=44 weight_order=wa
[conv2d] channel=1056 weight_order=wa act=sigmoid
[eltwise] input=*,B5G_ACT
[conv2d] channel=176 act=linear 
[eltwise] input=*,B5F_ADD mode=add output=P4

#BLOCK 6 [c,29,29]->[c,15,15] (9), kernel=5)

[conv2d] channel=1056
[conv2d] kernel=5 group=1056 channel=1056 stride=2 output=B6A_ACT
[pooling] 
[reshape] shape=-1,1,1
[conv2d] channel=44 weight_order=wa
[conv2d] channel=1056 weight_order=wa act=sigmoid
[eltwise] input=*,B6A_ACT
[conv2d] channel=304 act=linear output=B6A_PRO

[conv2d] channel=1824
[conv2d] kernel=5 group=1824 channel=1824 output=B6B_ACT
[pooling] 
[reshape] shape=-1,1,1
[conv2d] channel=76 weight_order=wa
[conv2d] channel=1824 weight_order=wa act=sigmoid
[eltwise] input=*,B6B_ACT 
[conv2d] channel=304 act=linear
[eltwise] mode=add input=*,B6A_PRO output=B6B_ADD

[conv2d] channel=1824
[conv2d] kernel=5 group=1824 channel=1824 output=B6C_ACT
[pooling] 
[reshape] shape=-1,1,1
[conv2d] channel=76 weight_order=wa
[conv2d] channel=1824 weight_order=wa act=sigmoid
[eltwise] input=*,B6C_ACT
[conv2d] channel=304 act=linear 
[eltwise] mode=add input=*,B6B_ADD output=B6C_ADD

[conv2d] channel=1824
[conv2d] kernel=5 group=1824 channel=1824 output=B6D_ACT
[pooling] 
[reshape] shape=-1,1,1
[conv2d] channel=76 weight_order=wa
[conv2d] channel=1824 weight_order=wa act=sigmoid
[eltwise] input=*,B6D_ACT
[conv2d] channel=304 act=linear 
[eltwise] mode=add input=*,B6C_ADD output=B6D_ADD

[conv2d] channel=1824
[conv2d] kernel=5 group=1824 channel=1824 output=B6E_ACT
[pooling] 
[reshape] shape=-1,1,1
[conv2d] channel=76 weight_order=wa
[conv2d] channel=1824 weight_order=wa act=sigmoid
[eltwise] input=*,B6E_ACT
[conv2d] channel=304 act=linear 
[eltwise] mode=add input=*,B6D_ADD output=B6E_ADD

[conv2d] channel=1824
[conv2d] kernel=5 group=1824 channel=1824 output=B6F_ACT
[pooling] 
[reshape] shape=-1,1,1
[conv2d] channel=76 weight_order=wa
[conv2d] channel=1824 weight_order=wa act=sigmoid
[eltwise] input=*,B6F_ACT
[conv2d] channel=304 act=linear 
[eltwise] mode=add input=*,B6E_ADD output=B6F_ADD

[conv2d] channel=1824
[conv2d] kernel=5 group=1824 channel=1824 output=B6G_ACT
[pooling] 
[reshape] shape=-1,1,1
[conv2d] channel=76 weight_order=wa
[conv2d] channel=1824 weight_order=wa act=sigmoid
[eltwise] input=*,B6G_ACT
[conv2d] channel=304 act=linear 
[eltwise] mode=add input=*,B6F_ADD output=B6G_ADD

[conv2d] channel=1824
[conv2d] kernel=5 group=1824 channel=1824 output=B6H_ACT
[pooling] 
[reshape] shape=-1,1,1
[conv2d] channel=76 weight_order=wa
[conv2d] channel=1824 weight_order=wa act=sigmoid
[eltwise] input=*,B6H_ACT
[conv2d] channel=304 act=linear 
[eltwise] mode=add input=*,B6G_ADD output=B6H_ADD

[conv2d] channel=1824
[conv2d] kernel=5 group=1824 channel=1824 output=B6I_ACT
[pooling]
[reshape] shape=-1,1,1
[conv2d] channel=76 weight_order=wa
[conv2d] channel=1824 weight_order=wa act=sigmoid
[eltwise] input=*,B6I_ACT
[conv2d] channel=304 act=linear 
[eltwise] mode=add input=*,B6H_ADD

#BLOCK 7 [c,15,15]->[c,15,15] (3)

[conv2d] channel=1824
[conv2d] kernel=3 group=1824 channel=1824 output=B7A_ACT
[pooling] 
[reshape] shape=-1,1,1
[conv2d] channel=76 weight_order=wa
[conv2d] channel=1824 weight_order=wa act=sigmoid
[eltwise] input=*,B7A_ACT
[conv2d] channel=512 act=linear output=B7A_PRO

[conv2d] channel=3072
[conv2d] kernel=3 group=3072 channel=3072 output=B7B_ACT
[pooling] 
[reshape] shape=-1,1,1
[conv2d] channel=128 weight_order=wa
[conv2d] channel=3072 weight_order=wa act=sigmoid
[eltwise] input=*,B7B_ACT
[conv2d] channel=512 act=linear
[eltwise] mode=add input=*,B7A_PRO output=B7B_ADD

[conv2d] channel=3072
[conv2d] kernel=3 group=3072 channel=3072 output=B7C_ACT
[pooling] 
[reshape] shape=-1,1,1
[conv2d] channel=128 weight_order=wa
[conv2d] channel=3072 weight_order=wa act=sigmoid
[eltwise] input=*,B7C_ACT
[conv2d] channel=512 act=linear 
[eltwise] mode=add input=*,B7B_ADD output=P5


#========= Bifpn0 ===============================
# FIRST TIME0 start
[conv2d] input=P5 channel=288 kernel=1,1 stride=1,1 weight_order=warbmv bn_eps=0.001 act=linear #P5 - > P6IN
[pooling] mode=max kernel=3,3 stride=2,2 pad=same pad_val=0 output=P6IN_F0
[pooling] input=P6IN_F0 mode=max kernel=3,3 stride=2,2 pad=same pad_val=0 output=P7IN_F0
[conv2d] input=P5 channel=288 kernel=1,1 stride=1,1 weight_order=warbmv bn_eps=0.001 act=linear output=P5IN_F0 #P5 - > P5IN
[conv2d] input=P4 channel=288 kernel=1,1 stride=1,1 weight_order=warbmv bn_eps=0.001 act=linear output=P4IN_F0 #P4 - > P4IN
[conv2d] input=P3 channel=288 kernel=1,1 stride=1,1 weight_order=warbmv bn_eps=0.001 act=linear output=P3IN_F0 #P3 - > P3IN
# FIRST TIME0 end

[upsample] input=P7IN_F0 factor_size=2 #upsize nearest
[fpn] input=P6IN_F0,* eps=0.0001 act=swish
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P6UP_F0

[upsample] input=P6UP_F0 factor_size=2 #upsize nearest
[fpn] input=P5IN_F0,* eps=0.0001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P5UP_F0

[upsample] input=P5UP_F0 factor_size=2 #upsize nearest
[fpn] input=P4IN_F0,* eps=0.0001 act=swish
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P4UP_F0

[upsample] input=P4UP_F0 factor_size=2 #upsize nearest
[fpn] input=P3IN_F0,* eps=0.0001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P3OUT_F0

# FIRST TIME1 start
[conv2d] input=P4 channel=288 kernel=1,1 stride=1,1 pad=same weight_order=warbmv bn_eps=0.001 act=linear output=P4IN_NEW
[conv2d] input=P5 channel=288 kernel=1,1 stride=1,1 pad=same weight_order=warbmv bn_eps=0.001 act=linear output=P5IN_NEW
# FIRST TIME1 end

[pooling] input=P3OUT_F0 mode=max pad_val=0 kernel=3,3 stride=2,2 pad=same #downsize max pool
[fpn] input=P4IN_NEW,P4UP_F0,* eps=0.0001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P4OUT_F0

[pooling] input=P4OUT_F0 mode=max pad_val=0 kernel=3,3 stride=2,2 pad=same #downsize max pool
[fpn] input=P5IN_NEW,P5UP_F0,* eps=0.0001 act=swish
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P5OUT_F0

[pooling] input=P5OUT_F0 mode=max pad_val=0 kernel=3,3 stride=2,2 pad=same #downsize max pool
[fpn] input=P6IN_F0,P6UP_F0,* eps=0.0001 act=swish
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P6OUT_F0

[pooling] input=P6OUT_F0 mode=max pad_val=0 kernel=3,3 stride=2,2 pad=same #downsize max pool
[fpn] input=P7IN_F0,* eps=0.0001 act=swish
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P7OUT_F0

#========= Bifpn1 ===============================
[upsample] input=P7OUT_F0 factor_size=2 #upsize nearest
[fpn] input=P6OUT_F0,* eps=0.0001 act=swish  
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P6UP_F1

[upsample] input=P6UP_F1 factor_size=2 #upsize nearest
[fpn] input=P5OUT_F0,* eps=0.0001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P5UP_F1

[upsample] input=P5UP_F1 factor_size=2 #upsize nearest
[fpn] input=P4OUT_F0,* eps=0.0001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P4UP_F1

[upsample] input=P4UP_F1 factor_size=2 #upsize nearest
[fpn] input=P3OUT_F0,* eps=0.0001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P3OUT_F1

[pooling] input=P3OUT_F1 mode=max pad_val=0 kernel=3,3 stride=2,2 pad=same #downsize max pool
[fpn] input=P4OUT_F0,P4UP_F1,* eps=0.0001 act=swish
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P4OUT_F1

[pooling] input=P4OUT_F1 mode=max pad_val=0 kernel=3,3 stride=2,2 pad=same #downsize max pool
[fpn] input=P5OUT_F0,P5UP_F1,* eps=0.0001 act=swish
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P5OUT_F1

[pooling] input=P5OUT_F1 mode=max pad_val=0 kernel=3,3 stride=2,2 pad=same #downsize max pool
[fpn] input=P6OUT_F0,P6UP_F1,* eps=0.0001 act=swish
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P6OUT_F1

[pooling] input=P6OUT_F1 mode=max pad_val=0 kernel=3,3 stride=2,2 pad=same #downsize max pool
[fpn] input=P7OUT_F0,* eps=0.0001 act=swish
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P7OUT_F1

#========= Bifpn2 ===============================
[upsample] input=P7OUT_F1 factor_size=2 #upsize nearest
[fpn] input=P6OUT_F1,* eps=0.0001 act=swish  
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P6UP_F2

[upsample] input=P6UP_F2 factor_size=2 #upsize nearest
[fpn] input=P5OUT_F1,* eps=0.0001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P5UP_F2

[upsample] input=P5UP_F2 factor_size=2 #upsize nearest
[fpn] input=P4OUT_F1,* eps=0.0001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P4UP_F2

[upsample] input=P4UP_F2 factor_size=2 #upsize nearest
[fpn] input=P3OUT_F1,* eps=0.0001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P3OUT_F2

[pooling] input=P3OUT_F2 mode=max pad_val=0 kernel=3,3 stride=2,2 pad=same #downsize max pool
[fpn] input=P4OUT_F1,P4UP_F2,* eps=0.0001 act=swish
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P4OUT_F2

[pooling] input=P4OUT_F2 mode=max pad_val=0 kernel=3,3 stride=2,2 pad=same #downsize max pool
[fpn] input=P5OUT_F1,P5UP_F2,* eps=0.0001 act=swish
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P5OUT_F2

[pooling] input=P5OUT_F2 mode=max pad_val=0 kernel=3,3 stride=2,2 pad=same #downsize max pool
[fpn] input=P6OUT_F1,P6UP_F2,* eps=0.0001 act=swish
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P6OUT_F2

[pooling] input=P6OUT_F2 mode=max pad_val=0 kernel=3,3 stride=2,2 pad=same #downsize max pool
[fpn] input=P7OUT_F1,* eps=0.0001 act=swish
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P7OUT_F2

#========= Bifpn3 ===============================
[upsample] input=P7OUT_F2 factor_size=2 #upsize nearest
[fpn] input=P6OUT_F2,* eps=0.0001 act=swish  
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P6UP_F3

[upsample] input=P6UP_F3 factor_size=2 #upsize nearest
[fpn] input=P5OUT_F2,* eps=0.0001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P5UP_F3

[upsample] input=P5UP_F3 factor_size=2 #upsize nearest
[fpn] input=P4OUT_F2,* eps=0.0001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P4UP_F3

[upsample] input=P4UP_F3 factor_size=2 #upsize nearest
[fpn] input=P3OUT_F2,* eps=0.0001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P3OUT_F3

[pooling] input=P3OUT_F3 mode=max pad_val=0 kernel=3,3 stride=2,2 pad=same #downsize max pool
[fpn] input=P4OUT_F2,P4UP_F3,* eps=0.0001 act=swish
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P4OUT_F3

[pooling] input=P4OUT_F3 mode=max pad_val=0 kernel=3,3 stride=2,2 pad=same #downsize max pool
[fpn] input=P5OUT_F2,P5UP_F3,* eps=0.0001 act=swish
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P5OUT_F3

[pooling] input=P5OUT_F3 mode=max pad_val=0 kernel=3,3 stride=2,2 pad=same #downsize max pool
[fpn] input=P6OUT_F2,P6UP_F3,* eps=0.0001 act=swish
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P6OUT_F3

[pooling] input=P6OUT_F3 mode=max pad_val=0 kernel=3,3 stride=2,2 pad=same #downsize max pool
[fpn] input=P7OUT_F2,* eps=0.0001 act=swish
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P7OUT_F3

#========= Bifpn4 ===============================
[upsample] input=P7OUT_F3 factor_size=2 #upsize nearest
[fpn] input=P6OUT_F3,* eps=0.0001 act=swish  
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P6UP_F4

[upsample] input=P6UP_F4 factor_size=2 #upsize nearest
[fpn] input=P5OUT_F3,* eps=0.0001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P5UP_F4

[upsample] input=P5UP_F4 factor_size=2 #upsize nearest
[fpn] input=P4OUT_F3,* eps=0.0001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P4UP_F4

[upsample] input=P4UP_F4 factor_size=2 #upsize nearest
[fpn] input=P3OUT_F3,* eps=0.0001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P3OUT_F4

[pooling] input=P3OUT_F4 mode=max pad_val=0 kernel=3,3 stride=2,2 pad=same #downsize max pool
[fpn] input=P4OUT_F3,P4UP_F4,* eps=0.0001 act=swish
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P4OUT_F4

[pooling] input=P4OUT_F4 mode=max pad_val=0 kernel=3,3 stride=2,2 pad=same #downsize max pool
[fpn] input=P5OUT_F3,P5UP_F4,* eps=0.0001 act=swish
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P5OUT_F4

[pooling] input=P5OUT_F4 mode=max pad_val=0 kernel=3,3 stride=2,2 pad=same #downsize max pool
[fpn] input=P6OUT_F3,P6UP_F4,* eps=0.0001 act=swish
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P6OUT_F4

[pooling] input=P6OUT_F4 mode=max pad_val=0 kernel=3,3 stride=2,2 pad=same #downsize max pool
[fpn] input=P7OUT_F3,* eps=0.0001 act=swish
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P7OUT_F4

#========= Bifpn5 ===============================
[upsample] input=P7OUT_F4 factor_size=2 #upsize nearest
[fpn] input=P6OUT_F4,* eps=0.0001 act=swish  
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P6UP_F5

[upsample] input=P6UP_F5 factor_size=2 #upsize nearest
[fpn] input=P5OUT_F4,* eps=0.0001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P5UP_F5

[upsample] input=P5UP_F5 factor_size=2 #upsize nearest
[fpn] input=P4OUT_F4,* eps=0.0001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P4UP_F5

[upsample] input=P4UP_F5 factor_size=2 #upsize nearest
[fpn] input=P3OUT_F4,* eps=0.0001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P3OUT_F5

[pooling] input=P3OUT_F5 mode=max pad_val=0 kernel=3,3 stride=2,2 pad=same #downsize max pool
[fpn] input=P4OUT_F4,P4UP_F5,* eps=0.0001 act=swish
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P4OUT_F5

[pooling] input=P4OUT_F5 mode=max pad_val=0 kernel=3,3 stride=2,2 pad=same #downsize max pool
[fpn] input=P5OUT_F4,P5UP_F5,* eps=0.0001 act=swish
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P5OUT_F5

[pooling] input=P5OUT_F5 mode=max pad_val=0 kernel=3,3 stride=2,2 pad=same #downsize max pool
[fpn] input=P6OUT_F4,P6UP_F5,* eps=0.0001 act=swish
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P6OUT_F5

[pooling] input=P6OUT_F5 mode=max pad_val=0 kernel=3,3 stride=2,2 pad=same #downsize max pool
[fpn] input=P7OUT_F4,* eps=0.0001 act=swish
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P7OUT_F5

#========= Bifpn6 ===============================
[upsample] input=P7OUT_F5 factor_size=2 #upsize nearest
[fpn] input=P6OUT_F5,* eps=0.0001 act=swish  
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P6UP_F6

[upsample] input=P6UP_F6 factor_size=2 #upsize nearest
[fpn] input=P5OUT_F5,* eps=0.0001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P5UP_F6

[upsample] input=P5UP_F6 factor_size=2 #upsize nearest
[fpn] input=P4OUT_F5,* eps=0.0001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P4UP_F6

[upsample] input=P4UP_F6 factor_size=2 #upsize nearest
[fpn] input=P3OUT_F5,* eps=0.0001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P3OUT_F6

[pooling] input=P3OUT_F6 mode=max pad_val=0 kernel=3,3 stride=2,2 pad=same #downsize max pool
[fpn] input=P4OUT_F5,P4UP_F6,* eps=0.0001 act=swish
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P4OUT_F6

[pooling] input=P4OUT_F6 mode=max pad_val=0 kernel=3,3 stride=2,2 pad=same #downsize max pool
[fpn] input=P5OUT_F5,P5UP_F6,* eps=0.0001 act=swish
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P5OUT_F6

[pooling] input=P5OUT_F6 mode=max pad_val=0 kernel=3,3 stride=2,2 pad=same #downsize max pool
[fpn] input=P6OUT_F5,P6UP_F6,* eps=0.0001 act=swish
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P6OUT_F6

[pooling] input=P6OUT_F6 mode=max pad_val=0 kernel=3,3 stride=2,2 pad=same #downsize max pool
[fpn] input=P7OUT_F5,* eps=0.0001 act=swish
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=linear output=P7OUT_F6

# REGRESSION
[conv2d] input=P3OUT_F6 channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=36 kernel=1,1 stride=1,1 pad=same group=1 weight_order=wa bn_eps=0.001 act=linear
[reshape] before_trans=1,2,0 shape=-1,4 output=R3

[conv2d] input=P4OUT_F6 channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=36 kernel=1,1 stride=1,1 pad=same group=1 weight_order=wa bn_eps=0.001 act=linear
[reshape] before_trans=1,2,0 shape=-1,4 output=R4

[conv2d] input=P5OUT_F6 channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=36 kernel=1,1 stride=1,1 pad=same group=1 weight_order=wa bn_eps=0.001 act=linear
[reshape] before_trans=1,2,0 shape=-1,4 output=R5

[conv2d] input=P6OUT_F6 channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=36 kernel=1,1 stride=1,1 pad=same group=1 weight_order=wa bn_eps=0.001 act=linear
[reshape] before_trans=1,2,0 shape=-1,4 output=R6

[conv2d] input=P7OUT_F6 channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=36 kernel=1,1 stride=1,1 pad=same group=1 weight_order=wa bn_eps=0.001 act=linear
[reshape] before_trans=1,2,0 shape=-1,4 output=R7

#[concat] input=R3,R4,R5,R6,R7 axis=0 output=ROUT

# CLASSIFICATION
[conv2d] input=P3OUT_F6 channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=$CLASS_COUNT*9 kernel=1,1 stride=1,1 pad=same group=1 weight_order=wa bn_eps=0.001 act=sigmoid
[reshape] before_trans=1,2,0 shape=-1,$CLASS_COUNT output=C3

[conv2d] input=P4OUT_F6 channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=$CLASS_COUNT*9 kernel=1,1 stride=1,1 pad=same group=1 weight_order=wa bn_eps=0.001 act=sigmoid
[reshape] before_trans=1,2,0 shape=-1,$CLASS_COUNT output=C4

[conv2d] input=P5OUT_F6 channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=$CLASS_COUNT*9 kernel=1,1 stride=1,1 pad=same group=1 weight_order=wa bn_eps=0.001 act=sigmoid
[reshape] before_trans=1,2,0 shape=-1,$CLASS_COUNT output=C5

[conv2d] input=P6OUT_F6 channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=$CLASS_COUNT*9 kernel=1,1 stride=1,1 pad=same group=1 weight_order=wa bn_eps=0.001 act=sigmoid
[reshape] before_trans=1,2,0 shape=-1,$CLASS_COUNT output=C6

[conv2d] input=P7OUT_F6 channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=288 kernel=1,1 stride=1,1 pad=same group=1 weight_order=warbmv bn_eps=0.001 act=swish 
[conv2d] channel=288 kernel=3,3 stride=1,1 pad=same group=288 weight_order=w act=linear
[conv2d] channel=$CLASS_COUNT*9 kernel=1,1 stride=1,1 pad=same group=1 weight_order=wa bn_eps=0.001 act=sigmoid
[reshape] before_trans=1,2,0 shape=-1,$CLASS_COUNT output=C7
[concat] input=C3,C4,C5,C6,C7 axis=0 output=COUT

[detect] input=R3,C3 mode=efficientdet prob_threshold=0.2 stride=8 scale=1,1.25992105,1.58740105 ratio=1.0,1.0,1.4,0.7,0.7,1.4 input_size=$MODEL_SIZE output=D3
[detect] input=R4,C4 mode=efficientdet prob_threshold=0.2 stride=16 scale=1,1.25992105,1.58740105 ratio=1.0,1.0,1.4,0.7,0.7,1.4 input_size=$MODEL_SIZE output=D4
[detect] input=R5,C5 mode=efficientdet prob_threshold=0.2 stride=32 scale=1,1.25992105,1.58740105 ratio=1.0,1.0,1.4,0.7,0.7,1.4 input_size=$MODEL_SIZE output=D5
[detect] input=R6,C6 mode=efficientdet prob_threshold=0.2 stride=64 scale=1,1.25992105,1.58740105 ratio=1.0,1.0,1.4,0.7,0.7,1.4 input_size=$MODEL_SIZE output=D6
[detect] input=R7,C7 mode=efficientdet prob_threshold=0.2 stride=128 scale=1,1.25992105,1.58740105 ratio=1.0,1.0,1.4,0.7,0.7,1.4 input_size=$MODEL_SIZE output=D7

[concat] input=D3,D4,D5,D6,D7 axis=0 output=DOUT

[nms] input=COUT,DOUT mode=efficientdet region_count=$REGION_COUNT nms_count=$NMS_COUNT nms_threshold=0.2 confid_thresh=0.2 output_type=$OUTPUT_TYPE input_size=$INPUT_SIZE model_size=$MODEL_SIZE output=FINAL*

[end]

#
